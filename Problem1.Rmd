---
title: "NEVR3004"
author: "Rasmus Munter"
date: "May 2, 2018"
output: pdf_document
---


```{r include=FALSE}
knitr::opts_chunk$set(include=FALSE, cache=TRUE)
library('ggplot2')
library('directlabels')
```
# Project 1

This is an investigation of neuron specificity to head direction in mice. The dataset consists of finished data from tetrodes in a mouse brain and has been preprocessed to extract the firing of individual neurons. To simplify finding neurons with a relation with head angle the following plot.

```{r}
source('./util/importData.R')
data1 = importData('./Mouse12-120806/Mouse12-120806', 12)
```

```{r echo=FALSE, include=TRUE}
source('./util/problem1.R')
tuning_curves1 = createTuningCurveDataFrame(data1)
ggplot(data=tuning_curves1, aes(x=angle_bins, y=firing_rate, color=cell)) + 
    facet_wrap( ~ tetrode, ncol=4, scale='free_y') +
    geom_line() + 
    geom_dl(aes(label=cell), color='black', method=list("top.bumpup", cex=0.5))

## ALL curves seperately
# ggplot(data=tuning_curves1, aes(x=angle_bins, y=firing_rate, color=cell)) + 
#     facet_wrap( ~ cellname, ncol=4, scale='free_y') +
#     geom_line() + 
#     geom_dl(aes(label=cell), color='black', method=list("top.bumpup", cex=0.5))+
#     theme(strip.background = element_blank(), strip.text.x = element_blank(),
#           axis.ticks.x = element_blank(), axis.ticks.y = element_blank(),
#           axis.text.x = element_blank(), axis.text.y = element_blank())
```

Cells that seem significant:

* T3C6
* T3C9
* T3C11
* T4C7
* T4C8
* T4C9

Strange cells:
* T4C2
* T3C2

Extracting only these:
```{r}
nice_cellnames = c('T3C6', 'T3C9', 'T3C11', 'T4C7', 'T4C8', 'T4C9')
nice_cells = tuning_curves1[tuning_curves1$cellname %in% nice_cellnames,]
ggplot(data=nice_cells, aes(x=angle_bins, y=firing_rate, color=cellname)) + 
    facet_wrap( ~ cellname, ncol=3, scale='free_y') +
    geom_line() + theme(legend.position="none")
```
```{r}
strange_cellnames = c('T3C2', 'T4C2')
strange_cells = tuning_curves1[tuning_curves1$cellname %in% strange_cellnames,]
ggplot(data=strange_cells, aes(x=angle_bins, y=firing_rate, color=cellname)) + 
    facet_wrap( ~ cellname, ncol=2, scale='free_y') +
    geom_line() + theme(legend.position="none")
```

# Project 2 

```{r}
source("./util/problem2.R")
nice_cells = addGaussianEstimate(nice_cells)
nice_cells = addCosineEstimate(nice_cells)
ggplot(data=nice_cells) + geom_line(aes(x=angle_bins, y=firing_rate, group=cellname)) +
    geom_line(aes(x=angle_bins, y=gaussian_estimate, group=cellname), color='red') +
    geom_line(aes(x=angle_bins, y=cosine_estimate, group=cellname), color='blue') +
    facet_wrap(~cellname, ncol=2)

```



