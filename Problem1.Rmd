---
title: "Problem1"
author: "Rasmus Munter"
date: "May 2, 2018"
output: pdf_document
---
```{r}
source('./Util/importData.R')
source('./Util/calculateFiringRate.R')
data = importData('./Mouse12-120806/Mouse12-120806', 13)
```

```{r}
firing_curves = data.frame()
for(cellname in data$cellnames){
    if(length(data$spiketimes[[cellname]]) != 0){
        result = calculateFiringRate(data$spiketimes[cellname], data$binned_awake_angle_data)
        result$angles_at_firing=NULL
        result$firing_rate = (result$firing_rate - min(result$firing_rate)) / (max(result$firing_rate) - min(result$firing_rate))
        if(max(result$firing_rate) > 0.5){
          result = as.data.frame(result)
          result = cbind(result, cellname)
          firing_curves = rbind(firing_curves, result)
        }
    }
}
# df = data.frame(x = result$plotting_angles, y = result$firing_rate)

library('ggplot2')
ggplot(data=firing_curves) + geom_line(aes(x=plotting_angles, y=firing_rate, color=cellname))
```